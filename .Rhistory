plot.roc(rc,print.auc=TRUE,main="ROC Curve")
plot(rc)
rc$auc
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5,cp=0.01),
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex.sub=1.2,cex.axis=1.2,cex=0.8,
split.cex = 0.8,split.prefix = "Split: ")
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5,cp=0.01),
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex.sub=1.2,cex=0.8,
split.cex = 0.8,split.prefix = "Split: ")
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5,cp=0.01),
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex.sub=1.2,cex=0.8,
split.cex = 0.8,split.prefix = "Split: ")
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5,cp=0.01),
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex.sub=1.2,cex=0.8,
split.cex = 0.8)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5,cp=0.01),
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex=0.8,
split.cex = 0.8)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5,cp=0.01),
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex=0.8,
)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5,cp=0.01),
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
split.cex = 0.8)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5,cp=0.01),
main="Decision Tree for Popularity Prediction",
cex.main=1.5,cex=0.8,
split.cex = 0.8)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5,cp=0.01),
)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5,cp=0.01)
)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex=0.8,
split.cex = 0.8)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5),
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex=0.8,
split.cex = 0.8)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex=0.8,
split.cex = 0.8)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5),
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex=0.8,
split.cex = 0.8)
confusionMatrix(pred,test$highp,positive = "yes")
plotcp(rpart_model)
rpart_model$cptable
rpart_model <- rpart(popularity ~ ., data = train, method = "anova",
control = rpart.control(minsplit = 20, maxdepth = 5, cp = 0.01))
summary(rpart_model)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,rpart.control(minsplit=20,maxdepth=5),
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex=0.8,
split.cex = 0.8)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,yesno=2,
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex=0.8,
split.cex = 0.8)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex=0.8,
split.cex = 0.8)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex=0.8,
split.cex = 0.8)
barplot(varImp(rpart_model)$Overall,main="Variable Importance",col=rainbow(10),horiz=TRUE,cex.names = .7,names.arg=row.names(varImp(rpart_model)))
pred<- predict(rpart_model,test,type="anova")
cm <- confusionMatrix(pred,test$highp,positive = "yes")
cm
pred<- predict(rpart_model,test,type="anova")
pred<- predict(rpart_model,test,type="vector")
cm <- confusionMatrix(pred,test$highp,positive = "yes")
pred_prob<- predict(rpart_model,test,type="prob")[,2]
rc<- roc(test$highp,pred_prob,levels=c("no","yes"))
plot.roc(rc,print.auc=TRUE,main="ROC Curve")
plot(rc)
rc$auc
plotcp(rpart_model)
rpart_model$cptable
spotify_data <- read_csv("/Users/Mehr/Documents/Semester 4/Visualisation/final/visualization_final_project/spotify_01.csv") %>%
slice_sample(prop = .1)%>%
na.omit() %>%
select_if(is.numeric)
hist(spotify_data$popularity)
highp<-ifelse(spotify_data$popularity >= 81,"yes","no")
highp<-as.factor(highp)
length(highp)
length(spotify_data$popularity)
new_spotify<-data.frame(spotify_data,highp)
names(new_spotify)
n_train<-round(nrow(new_spotify)*0.8)
ind<-sample(1:nrow(new_spotify),n_train)
train<-new_spotify[ind,]
test<-new_spotify[-ind,]
length(train)
length(test)
nrow(train)
nrow(test)
rpart_model<-rpart(highp~.,data=train,method="class",minsplit=20,maxdepth=5,cp=0.01)
rpart_model <- rpart(popularity ~ ., data = train, method = "anova",
control = rpart.control(minsplit = 20, maxdepth = 5, cp = 0.01))
summary(rpart_model)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex=0.8,
split.cex = 0.8)
barplot(varImp(rpart_model)$Overall,main="Variable Importance",col=rainbow(10),horiz=TRUE,cex.names = .7,names.arg=row.names(varImp(rpart_model)))
barplot(varImp(rpart_model)$Overall,main="Variable Importance",col=rainbow(10),horiz=TRUE,cex.names = .5,names.arg=row.names(varImp(rpart_model)))
pred<- predict(rpart_model,test,type="vector")
mse<- mse(test$popularity, pred)
mse
data(sonar)
data(Sonar)
library(mlbench)
data(Sonar)
head(Sonar,2)
nrow(Sonar)
n_train<- nrow(Sonar)*.70
ind<- sample(1:nrow(Sonar),n_train)
train<-Sonar[ind,]
test<-Sonar[-ind,]
svm_model<-svm(Class~.,data=train,type="C-classification",kernel="linear")
library(e1071)
svm_model<-svm(Class~.,data=train,type="C-classification",kernel="linear")
pred<-predict(svm_model,test,)
mse<- mean(pred==test$Class)
mse
svm_model<-svm(Class~.,data=train,type="C-classification",kernel="linear",cost=100)
pred<-predict(svm_model,test,)
mse<- mean(pred==test$Class)
mse
svm_model<-svm(Class~.,data=train,type="C-classification",kernel="radial",cost=100)
pred<-predict(svm_model,test,)
mse<- mean(pred==test$Class)
mse
tune.svm(Class~.,data=train,type="C-classification",kernel="radial",cost=100)
tune.svm(Class~.,data=train,type="C-classification",kernel="radial")
tune.svm(Class~.,data=train,kernel="radial")
tune.svm(x=train%>%select(-Class),y=train$Class,data=train,kernel="radial")
tune.svm(x=train%>%select(-Class),y=train$Class,data=train,gamma=10^(-3:3),kernel="radial",cost=c(.01,.1,1,10,100))
spotify_data <- read_csv("/Users/Mehr/Documents/Semester 4/Visualisation/final/visualization_final_project/spotify_01.csv") %>%
slice_sample(prop = .1)%>%
na.omit() %>%
select_if(is.numeric)
hist(spotify_data$popularity)
highp<-ifelse(spotify_data$popularity >= 81,"yes","no")
highp<-as.factor(highp)
length(highp)
length(spotify_data$popularity)
new_spotify<-data.frame(spotify_data,highp)
names(new_spotify)
n_train<-round(nrow(new_spotify)*0.8)
ind<-sample(1:nrow(new_spotify),n_train)
train<-new_spotify[ind,]
test<-new_spotify[-ind,]
length(train)
length(test)
nrow(train)
nrow(test)
rpart_model<-rpart(highp~.,data=train,method="class",minsplit=20,maxdepth=5,cp=0.01)
rpart_model <- rpart(popularity ~ ., data = train, method = "anova",
control = rpart.control(minsplit = 20, maxdepth = 5, cp = 0.01))
svm_spot <- svm(popularity ~ .,
data = train_,
type = "eps-regression",
kernel = "radial")
svm_spot <- svm(popularity ~ .,
data = train,
type = "eps-regression",
kernel = "radial")
summary(svm_spot)
summary(svm_spot)
preds<-predict(svm_spot,test)
mean_squared_error <- mean((train$popularity - predictions)^2)
preds<-predict(svm_spot,test)
mean_squared_error <- mean((train$popularity - preds)^2)
mean_squared_error
summary(rpart_model)
rpart.plot(rpart_model, type=3, extra=0, fallen.leaves=TRUE,
main="Decision Tree for Popularity Prediction",
box.palette="RdBu", shadow.col="gray", nn=TRUE,
cex.main=1.5,cex=0.8,
split.cex = 0.8)
summary(svm_spot)
plot(train$popularity , preds)
preds<-predict(svm_spot,test)
mean_squared_error <- mean((test$popularity - preds)^2)
mean_squared_error
plot(test$popularity , preds)
qqplot(test$popularity , preds)
plot(svm_model)
plot(svm_model,train)
plot(svm_model,train)
plot(svm_spot,train)
data(Sonar)
#svm_spot<-svm(highp~.,data=train,kernel="linear",cost=10,scale=FALSE)
head(Sonar,2)
n_train<- nrow(Sonar)*.70
ind<- sample(1:nrow(Sonar),n_train)
train<-Sonar[ind,]
test<-Sonar[-ind,]
svm_model<-svm(Class~.,data=train,type="C-classification",kernel="radial",cost=100)
pred<-predict(svm_model,test,)
mse<- mean(pred==test$Class)
mse
tune.svm(x=train%>%select(-Class),y=train$Class,data=train,gamma=10^(-3:3),kernel="radial",cost=c(.01,.1,1,10,100))
tune.svm(x=train%>%select(-Class),y=train$Class,data=train,gamma=10^(-3:3),kernel="radial",cost=c(.01,.1,1,10,100))
plot(svm_model,test)
svm_model<-svm(Class~.,data=train,type="C-classification",kernel="radial",cost=100)
plot(svm_model,test)
plot(svm_model,train)
svm_model<-svm(Class~.,data=train,type="C-classification",kernel="radial",cost=100)
plot(svm_model,train)
?tune.svm()
?tune()
spotify_data <- read_csv("/Users/Mehr/Documents/Semester 4/Visualisation/final/visualization_final_project/spotify_01.csv") %>%
slice_sample(prop = .1)%>%
na.omit() %>%
select_if(is.numeric)
hist(spotify_data$popularity)
highp<-ifelse(spotify_data$popularity >= 81,"yes","no")
highp<-as.factor(highp)
length(highp)
length(spotify_data$popularity)
new_spotify<-data.frame(spotify_data,highp)
names(new_spotify)
n_train<-round(nrow(new_spotify)*0.8)
ind<-sample(1:nrow(new_spotify),n_train)
train<-new_spotify[ind,]
test<-new_spotify[-ind,]
length(train)
length(test)
nrow(train)
nrow(test)
rpart_model<-rpart(highp~.,data=train,method="class",minsplit=20,maxdepth=5,cp=0.01)
tune(svm_spot,
train,kernel=c("linear","radial"),cost=c(.01,.1,1,10,100))
tune(svm_spot,
data=train,kernel=c("linear","radial"),cost=c(.01,.1,1,10,100))
tune(svm,
formula=popularity~.,
data=train,kernel=c("linear","radial"),cost=c(.01,.1,1,10,100))
tune(svm,
formula=popularity~.,
data=train,kernel=c("linear","radial"),ranges=list(cost=c(.01,.1,1,10,100)))
?tune.svm()
tune(svm,
formula=popularity~.,
data=train,kernel=c("linear","radial"),ranges=list(cost=c(1,10,100)))
tune(svm,
formula=popularity~.,
data=train,kernel=c("linear","radial"),ranges=list(cost=c(1,10,100)))
tune(svm,
formula=popularity~.,
data=train,kernel="linear",ranges=list(cost=c(1,10,100)))
plot(svm_model,train)
plot.svm(svm_model,train)
plot(svm_model,train)
library(e1071)
plot(svm_model,train)
## AIR BNB
library(shiny)
library(shinydashboard)
library(dplyr)
library(ggplot2)
library(randomForest)
library(plotly)
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
air<- read_csv("/users/mehr/downloads/listings.csv")
library(dplyr)
library(ggplot2)
library(randomForest)
library(randomForest)
library(readr)
library(plotly)
air<- read_csv("/users/mehr/downloads/listings.csv")
head(air)
colnames(air)
str(air)
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
head(air)
colnames(air)
str(air)
runApp('~/Documents/Semester 4/Visualisation/week11')
str(air)
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
str(air)
str(air)
ggplot(air ,aes(x=room_type,y=reviews_per_month))+
geom_bar()
runApp('~/Documents/Semester 4/Visualisation/week11')
str(air)
air%>%
filter(air$room_type=="Private room")%>%
summarize(avg_price=mean(price),reviews=mean(number_of_reviews))#%>%
air%>%
filter(air$room_type=="Private room")%>%
summarize(avg_price=mean(price,na.rm=TRUE),reviews=mean(number_of_reviews))#%>%
air%>%
filter(air$room_type=="Private room")%>%
summarize(avg_price=mean(price,na.rm=TRUE),reviews=mean(number_of_reviews))%>%
ggplot(,aes(x=room_type,y=avg_price))+
geom_bar()
air%>%
filter(room_type=="Private room")%>%
summarize(avg_price=mean(price,na.rm=TRUE),reviews=mean(number_of_reviews))%>%
ggplot(,aes(x=room_type,y=avg_price))+
geom_bar()
air%>%
filter(room_type=="Private room")%>%
summarize(avg_price=mean(price,na.rm=TRUE),reviews=mean(number_of_reviews))%>%
ggplot(aes(x=room_type,y=avg_price))+
geom_bar()
runApp('~/Documents/Semester 4/Visualisation/week11')
air%>%
filter(room_type=="Private room")%>%
group_by(room_type)%>%
summarize(avg_price=mean(price,na.rm=TRUE),reviews=mean(number_of_reviews))%>%
ggplot(aes(x=room_type,y=avg_price))+
geom_bar()
air%>%
filter(room_type=="Private room")%>%
group_by(room_type)%>%
summarize(avg_price=mean(price,na.rm=TRUE),reviews=mean(number_of_reviews))#%>%
str(air)
air%>%
filter(room_type=="Private room")%>%
group_by(room_type)%>%
mutate(avg_price=mean(price,na.rm=TRUE),reviews=mean(number_of_reviews))%>%
ggplot(aes(x=calculated_host_listings_count,y=avg_price))+
geom_bar()
air%>%
filter(room_type=="Private room")%>%
group_by(room_type)%>%
mutate(avg_price=mean(price,na.rm=TRUE),reviews=mean(number_of_reviews))#%>%
%>%
air%>%
filter(room_type=="Private room")%>%
group_by(room_type)%>%
mutate(avg_price=mean(price,na.rm=TRUE),reviews=mean(number_of_reviews))%>%
ggplot(aes(x=calculated_host_listings_count,y=avg_price))+
geom_bar()
calculated_host_listings_count
unique(air$calculated_host_listings_count)
filtered_data <- air %>% filter(room_type == input$room_type)
filtered_data <- air %>% filter(room_type == "Private room")
ggplot(data = filtered_data, aes(x = price, y = reviews_per_month)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
labs(title = "Price vs. Reviews Per Month", x = "Price", y = "Reviews per Month")
ggplot(data = filtered_data, aes(x = price, y = reviews_per_month)) +
geom_point(alpha = 0.5) +
#geom_smooth(method = "lm") +
labs(title = "Price vs. Reviews Per Month", x = "Price", y = "Reviews per Month")
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
sum(is.na(air))
nrow(air)
air<-na.omit(air)
sum(is.na(air))
nrow(air)
naniar::gg_miss_upset(air)
naniar::gg_miss_upset(air)
air<- read_csv("/users/mehr/downloads/listings.csv")
naniar::gg_miss_upset(air)
air<- read_csv("/users/mehr/downloads/listings.csv")
gg_miss_upset(air)
air<-air%>%select(-neighbourhood_group,-license)
library(naniar)
air<- read_csv("/users/mehr/downloads/listings.csv")
gg_miss_upset(air)
air<-air%>%select(-neighbourhood_group,-license)
nrow(air)
sum(is.na(air))
gg_miss_upset(air)
air<-na.omit(air)
gg_miss_upset(air)
sum(is.na(air))
head(air)
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
air[is.na(price)]=mean(air$price,na.rm=TRUE)
air%>%
ifelse(is.na(price),mean(price,na.rm=TRUE),price)
air%>%
ifelse(price=is.na(price),mean(price,na.rm=TRUE),price)
air%>%
mutate(ifelse(price=is.na(price),mean(price,na.rm=TRUE),price))
air%>%
mutate(price=ifelse(is.na(price),mean(price,na.rm=TRUE),price))
air<-air%>%
mutate(price=ifelse(is.na(price),mean(price,na.rm=TRUE),price))
air<- read_csv("/users/mehr/downloads/listings.csv")
gg_miss_upset(air)
air<-air%>%select(-neighbourhood_group,-license)%>%
mutate(price=ifelse(is.na(price),mean(price,na.rm=TRUE),price))
nrow(air)
sum(is.na(air))
air<-na.omit(air)
gg_miss_upset(air)
head(air)
colnames(air)
str(air)
gg_miss_upset(air)
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
rsconnect::setAccountInfo(name='cy21r8-mehrdad-lashgari', token='9936A2E73981CFB9EC3E9C66B14D5DF1', secret='N/JV+1O0eKsIDcBIGzsRMixP07LC+A0ULBRmFgQu')
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11')
runApp('~/Documents/Semester 4/Visualisation/week11/rsconnect/shinyapps.io/cy21r8-mehrdad-lashgari')
runApp('~/Documents/Semester 4/Visualisation/week11/rsconnect/shinyapps.io/cy21r8-mehrdad-lashgari')
runApp('~/Documents/Semester 4/Visualisation/week11/rsconnect/shinyapps.io/cy21r8-mehrdad-lashgari')
runApp('~/Documents/Semester 4/Visualisation/week11')
rsconnect::deployApp('/users/mehr/Documents/Semester 4/Visualisation/week11')
runApp('~/Downloads/week11')
runApp('~/Downloads/week11')
runApp('~/Downloads/week11')
gwd()
pwd()
getwd()
setwd("/users/mehr/Documents/Semester 4/Visualisation/week11")
getwd()
runApp()
getwd()
setwd("Users/Mehr/Documents/Semester 4/Visualisation/final/visualization_final_project")
getwd()
setwd("Users/Mehr/Documents/Semester 4/Visualisation/final/visualization_final_project/")
setwd("/Users/Mehr/Documents/Semester 4/Visualisation/final/visualization_final_project/")
getwd()
runApp()
library(shiny)
library(shinydashboard)
library(dplyr)
library(ggplot2)
library(randomForest)
library(plotly)
library(lubridate)
library(corrplot)
library(heatmaply)
library(DT)
library(readr)
library(tidyr)
library(Metrics)
library(caret)
library(leaflet)
library(maps)
library(tools)
library(ggbiplot)
library(countrycode)
runApp()
library(factoextra)
runApp()
runApp()
runApp()
runApp()
applications()
forgetDeployment()
forgetDeployment()
library(factoextra)
runApp()
runApp()
runApp()
runApp()
forgetDeployment()
runApp()
forgetDeployment()
runApp()
library(scales)
runApp()
runApp()
runApp()
runApp()
